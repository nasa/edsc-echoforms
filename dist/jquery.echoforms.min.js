/*
 *  echoforms.js - v1.0.0
 */
require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports={pluginName:"echoforms"}},{}],2:[function(a,b){var c,d;d=a("../util.coffee"),c=function(){function a(a){this.message=a}return a.prototype.check=function(){return d.warn(""+this.constructor.name+" must override check")},a}(),b.exports=c},{"../util.coffee":33}],3:[function(a,b){b.exports={Pattern:a("./pattern.coffee"),Required:a("./required.coffee"),Type:a("./type.coffee"),XPath:a("./xpath.coffee")}},{"./pattern.coffee":4,"./required.coffee":5,"./type.coffee":6,"./xpath.coffee":7}],4:[function(a,b){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./base.coffee"),d=function(a){function b(a,c){this.pattern=new RegExp("^"+a+"$"),b.__super__.constructor.call(this,null!=c?c:"Invalid")}return f(b,a),b.prototype.check=function(a){return!a||a instanceof Array&&0===a.length||null!==this.pattern.exec(a)},b}(c),b.exports=d},{"./base.coffee":2}],5:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./base.coffee"),e=a("../util.coffee").execXPath,d=function(a){function b(a,c){this.xpath=a,null==c&&(c="Required field"),b.__super__.constructor.call(this,c)}return g(b,a),b.prototype.check=function(a,b,c){return a instanceof Array&&0===a.length&&(a=null),!!a||!e(b,this.xpath,c)},b}(c),b.exports=d},{"../util.coffee":33,"./base.coffee":2}],6:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./base.coffee"),e=a("../util.coffee"),d=function(a){function b(a,c){var d,e,f;null==c&&(c=null),f=a.match(/^(?:[^:]+:)?(.*)$/),this.type=f?f[1]:a,e=function(){switch(this.type){case"double":return"number";case"long":return"integer between -2^63 and 2^63-1";case"int":return"integer between -2,147,483,648 and 2,147,483,647";case"short":return"integer between -32,768 and 32,767";case"datetime":return"date/time with format YYYY-MM-DDTHH:MM:SS";case"boolean":return"true or false";default:return this.type}}.call(this),d=/^[aeiou]/i.test(e)?"an":"a",b.__super__.constructor.call(this,null!=c?c:"Value must be "+d+" "+e)}return g(b,a),b.MIN_SHORT=-Math.pow(2,15),b.MAX_SHORT=Math.pow(2,15)-1,b.MIN_INT=-Math.pow(2,31),b.MAX_INT=Math.pow(2,31)-1,b.MIN_LONG=-Math.pow(2,63),b.MAX_LONG=Math.pow(2,63)-1,b.prototype.check=function(a){if(!a)return!0;switch(this.type){case"string":return!0;case"anyuri":return!0;case"double":return this.checkDouble(a);case"long":return this.checkLong(a);case"int":return this.checkInt(a);case"short":return this.checkShort(a);case"datetime":return this.checkDateTime(a);case"boolean":return this.checkBoolean(a);default:return e.warn("Unable to validate type: ",this.type),!0}},b.prototype._checkIntegerRange=function(a,b,c){var d;return d=Number(c),!isNaN(d)&&d>=a&&b>=d&&-1===c.indexOf(".")},b.prototype.checkDouble=function(a){return!isNaN(Number(a))},b.prototype.checkLong=function(a){return this._checkIntegerRange(b.MIN_LONG,b.MAX_LONG,a)},b.prototype.checkInt=function(a){return this._checkIntegerRange(b.MIN_INT,b.MAX_INT,a)},b.prototype.checkShort=function(a){return this._checkIntegerRange(b.MIN_SHORT,b.MAX_SHORT,a)},b.prototype.checkBoolean=function(a){return"true"===a||"false"===a},b.prototype.checkDateTime=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;return a.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$/)?(k=a.split("T"),b=k[0],i=k[1],l=function(){var a,c,d,e;for(d=b.split("-"),e=[],a=0,c=d.length;c>a;a++)h=d[a],e.push(parseInt(h,10));return e}(),j=l[0],f=l[1],c=l[2],m=function(){var a,b,c,d;for(c=i.split(":"),d=[],a=0,b=c.length;b>a;a++)h=c[a],d.push(parseInt(h,10));return d}(),d=m[0],e=m[1],g=m[2],f>=1&&12>=f&&c>=1&&31>=c&&24>d&&60>e&&60>g):!1},b}(c),b.exports=d},{"../util.coffee":33,"./base.coffee":2}],7:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./base.coffee"),e=a("../util.coffee").execXPath,d=function(a){function b(a,c){this.xpath=a,b.__super__.constructor.call(this,null!=c?c:"Invalid")}return g(b,a),b.prototype.check=function(a,b,c){return e(b,this.xpath,c)},b}(c),b.exports=d},{"../util.coffee":33,"./base.coffee":2}],8:[function(a,b){var c,d,e,f,g=function(a,b){return function(){return a.apply(b,arguments)}};e=a("../constraints/index.coffee"),c=a("jquery"),f=a("../util.coffee"),d=function(){function a(b,d,e,f){var h,i,j,k,l;for(this.ui=b,this.model=d,this.controlClasses=e,this.resolver=f,this.onChange=g(this.onChange,this),this.changed=g(this.changed,this),this.refExpr=b.attr("ref"),this.id=null!=(k=b.attr("id"))?k:"echoforms-control-"+a.echoformsControlUniqueId++,this.relevantExpr=b.attr("relevant"),this.requiredExpr=b.attr("required"),this.readonlyExpr=b.attr("readonly"),this.label=b.attr("label"),l=b.children("help"),i=0,j=l.length;j>i;i++)h=l[i],this.help=c(h).text();this.loadConstraints(),this.el=this.buildDom()}return a.echoformsControlUniqueId=0,a.prototype.loadConstraints=function(){var a,b,d,f,g,h,i,j;for(this.constraints=[],this.requiredExpr&&(this.requiredConstraint=new e.Required(this.requiredExpr),this.constraints.push(this.requiredConstraint)),i=this.ui.find("> constraints > constraint"),j=[],g=0,h=i.length;h>g;g++)b=i[g],b=c(b),a=b.children("alert").text(),d=b.children("pattern"),f=b.children("xpath"),d.length>0&&this.constraints.push(new e.Pattern(d.text(),a)),f.length>0?j.push(this.constraints.push(new e.XPath(f.text(),a))):j.push(void 0);return j},a.prototype.required=function(){return null!=this.requiredConstraint?!this.requiredConstraint.check(void 0,this.model,this.resolver):void 0},a.prototype.ref=function(){return null!=this.refExpr?c(this.xpath(this.refExpr)):this.model},a.prototype.refValue=function(){var a;try{return null!=this.refExpr?c.trim(this.ref().text()):void 0}catch(b){throw a=b,""+a+"<br/>Error found while accessing the model element associated with form ui control: ["+c("<div/>").text(this.ui[0].outerHTML).html()+"]."}},a.prototype.inputValue=function(){return f.warn(""+this.constructor.name+" must override inputValue")},a.prototype.loadFromModel=function(){},a.prototype.validate=function(){var a,b,c,d;return d=null==this.relevantExpr||!!this.xpath(this.relevantExpr),c=null!=this.readonlyExpr&&!!this.xpath(this.readonlyExpr),null!=this.relevantExpr&&this.relevant(d),null!=this.readonlyExpr&&this.readonly(c),b=function(){var b,c,d,e,f;for(d=this.constraints,f=[],b=0,c=d.length;c>b;b++)a=d[b],a.check(null!=(e=this.refValue())?e:this.inputValue(),this.model,this.resolver)||f.push(a.message);return f}.call(this),this.setErrors(b)},a.prototype.saveToModel=function(){},a.prototype.xpath=function(a){return f.execXPath(this.model,a,this.resolver)},a.prototype.element=function(){return null!=this.el?this.el:this.el=this.buildDom()},a.prototype.isChanged=function(){return this.refValue()!==this.inputValue()||!this.refExpr},a.prototype.changed=function(){return this.el.trigger("echoforms:modelchange")},a.prototype.relevant=function(a){var b,c;return null==a?!this.el.hasClass("echoforms-irrelevant"):(b=!!a,b!==this.relevant()?(this.el.toggleClass("echoforms-irrelevant",!b),this.el.toggle(b),c=this.ref(),b?c[0].removeAttribute("pruned"):c[0].setAttribute("pruned","true")):void 0)},a.prototype.readonly=function(a){var b;return null==a?this.el.hasClass("echoforms-readonly"):(b=!!a,b!==this.readonly()?(this.el.toggleClass("echoforms-readonly ui-state-disabled",b),this.updateReadonly(b)):void 0)},a.prototype.updateReadonly=function(a){return this.inputs().attr("disabled",a),this.inputs().attr("readonly",a)},a.prototype.onChange=function(){return this.isChanged()?(this.saveToModel(),this.changed()):void 0},a.prototype.buildLabelDom=function(){return null!=this.label?c("<label>",{"class":"echoforms-label","for":""+this.id+"-element"}).text(this.label):c()},a.prototype.buildHelpDom=function(){var a,b,d,e,f;for(b=c("<div>",{"class":"echoforms-help"}),f=this.ui.children("help"),d=0,e=f.length;e>d;d++)a=f[d],c("<p>",{"class":"echoforms-help-item"}).text(c(a).text()).appendTo(b);return b},a.prototype.buildControlDom=function(){return c("<div>",{id:this.id,"class":"echoforms-control echoforms-control-"+this.ui[0].nodeName})},a.prototype.buildElementsDom=function(){return c("<div>",{"class":"echoforms-elements"})},a.prototype.buildErrorsDom=function(){return c("<div>",{"class":"echoforms-errors"})},a.prototype.setErrors=function(a){var b,d,e,f,g;for(d=c(),f=0,g=a.length;g>f;f++)e=a[f],b=c('<div class="echoforms-error">'),b.text(e),d=d.add(b);return this.el.children(".echoforms-errors").empty().append(d)},a.prototype.buildDom=function(a){return null==a&&(a=null),this.buildControlDom().append(this.buildLabelDom()).append(this.buildElementsDom()).append(this.buildErrorsDom()).append(this.buildHelpDom())},a.prototype.addedToDom=function(){},a}(),b.exports=d},{"../constraints/index.coffee":3,"../util.coffee":33,jquery:"im90Iq"}],9:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("./input.coffee"),c=function(a){function b(){return e=b.__super__.constructor.apply(this,arguments)}return g(b,a),b.selector="input[type$=boolean]",b.prototype.inputClass="checkbox",b.prototype.inputElementType="checkbox",b.prototype.inputValue=function(){return this.inputs()[0].checked.toString()},b.prototype.loadFromModel=function(){return b.__super__.loadFromModel.call(this),this.refExpr?this.inputs()[0].checked="true"===this.refValue():void 0},b.prototype.buildDom=function(){var a;return a=b.__super__.buildDom.call(this),a.addClass("echoforms-control-checkbox"),a.children(".echoforms-elements").after(a.children(".echoforms-label")),a},b}(d),b.exports=c},{"./input.coffee":15}],10:[function(a,b){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("jquery"),d=a("../range.coffee"),e=function(a){function b(){return f=b.__super__.constructor.apply(this,arguments)}return h(b,a),b.selector="range",b.prototype.loadFromModel=function(){return b.__super__.loadFromModel.call(this),this.inputs().change()},b.prototype.addedToDom=function(){var a;return b.__super__.addedToDom.call(this),a=this.inputs(),c("<div/>").addClass("slider-output").insertAfter(a),a.bind("slider:ready slider:changed",function(){return c(this).nextAll(".slider-output").html(a.val())}),a.simpleSlider({snap:!0,range:[this.start,this.end],step:this.step,classPrefix:"echoforms"})},b}(d),b.exports=e},{"../range.coffee":17,jquery:"im90Iq"}],11:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("./grouping.coffee"),e=a("../util.coffee"),c=function(a){function b(a,c,d,e){var f=this;b.__super__.constructor.call(this,a,c,d,e),this.el.bind("echoforms:modelchange",function(){return f.loadFromModel(),f.validate()}),this.loadFromModel(),this.validate()}return g(b,a),b.prototype.ref=function(){return this.model.children()},b.prototype.isValid=function(){return 0===this.el.find(".echoforms-error:visible").length},b.prototype.serialize=function(a){var b;return null==a&&(a={}),b=this.model.children().clone(),(null==a.prune||a.prune===!0)&&b.find("*[pruned=true]").remove(),(null==a.prune||a.prune===!0)&&b.find("*:hasNoValue").remove(),e.printDOMToString(b[0])},b}(d),b.exports=c},{"../util.coffee":33,"./grouping.coffee":13}],12:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("./grouping.coffee"),c=function(a){function b(){return e=b.__super__.constructor.apply(this,arguments)}return g(b,a),b.selector="group",b}(d),b.exports=c},{"./grouping.coffee":13}],13:[function(a,b){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("jquery"),d=a("./base.coffee"),f=a("../util.coffee"),e=function(a){function b(a,c,d,e){a.removeAttr("required"),b.__super__.constructor.call(this,a,c,d,e)}return h(b,a),b.prototype.inputs=function(){return c()},b.prototype.loadFromModel=function(){var a,c,d,e,f;for(b.__super__.loadFromModel.call(this),e=this.controls,f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(a.loadFromModel());return f},b.prototype.buildLabelDom=function(){return null!=this.label?c("<h1>",{"class":"echoforms-label"}).text(this.label):c()},b.prototype.buildDom=function(){var a,d,e,g,h,i,j,k,l,m,n,o,p,q;for(j=b.__super__.buildDom.call(this).addClass("echoforms-grouping-control"),j.children(".echoforms-label").after(j.children(".echoforms-help")),e=this.ref(),e.length<1&&f.error("Could not find the model element associated with this group.  Verify that @ref ["+this.refExpr+"] is correct and that the namespace is set correctly"),k=this.ui,g=c(),this.controls=i=[],p=k.children(),l=0,n=p.length;n>l;l++)if(d=p[l],"help"!==d.nodeName&&"constraints"!==d.nodeName)for(q=this.controlClasses,m=0,o=q.length;o>m;m++)if(a=q[m],c(d).is(a.selector)){h=new a(c(d),e,this.controlClasses,this.resolver),i.push(h),g=g.add(h.el);break}return j.find(".echoforms-elements").replaceWith(c('<div class="echoforms-children">').append(g)),j},b.prototype.updateReadonly=function(a){var c,d,e,f,g;for(b.__super__.updateReadonly.call(this,a),f=this.controls,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.updateReadonly(a));return g},b.prototype.validate=function(){var a,c,d,e,f;for(b.__super__.validate.call(this),e=this.controls,f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(a.validate());return f},b.prototype.addedToDom=function(){var a,c,d,e,f;for(b.__super__.addedToDom.call(this),e=this.controls,f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(a.addedToDom());return f},b}(d),b.exports=e},{"../util.coffee":33,"./base.coffee":8,jquery:"im90Iq"}],14:[function(a,b){var c,d;c={Checkbox:a("./checkbox.coffee"),Input:a("./input.coffee"),UrlOutput:a("./urloutput.coffee"),Output:a("./output.coffee"),Select:a("./select.coffee"),Range:a("./range.coffee"),Secret:a("./secret.coffee"),Textarea:a("./textarea.coffee"),Group:a("./group.coffee"),Select:a("./select.coffee"),Tree:a("./tree.coffee"),TreeItem:a("./treeitem.coffee"),Selectref:a("./selectref.coffee"),Base:a("./base.coffee"),Typed:a("./typed.coffee"),Grouping:a("./grouping.coffee")},d=[c.Checkbox,c.Input,c.UrlOutput,c.Output,c.Select,c.Range,c.Secret,c.Group,c.Select,c.Selectref,c.Tree,c.TreeItem,c.Textarea],b.exports={matchList:d,classes:c,extras:{RangeSlider:a("./extras/rangeslider.coffee")}}},{"./base.coffee":8,"./checkbox.coffee":9,"./extras/rangeslider.coffee":10,"./group.coffee":12,"./grouping.coffee":13,"./input.coffee":15,"./output.coffee":16,"./range.coffee":17,"./secret.coffee":18,"./select.coffee":19,"./selectref.coffee":20,"./textarea.coffee":21,"./tree.coffee":22,"./treeitem.coffee":23,"./typed.coffee":24,"./urloutput.coffee":25}],15:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("./typed.coffee"),c=function(a){function b(){return e=b.__super__.constructor.apply(this,arguments)}return g(b,a),b.selector="input",b.prototype.inputClass="input",b.prototype.inputTag="input",b.prototype.inputElementType="text",b.prototype.inputAttrs=function(){var a;return a=b.__super__.inputAttrs.call(this),a.type=this.inputElementType,"datetime"===this.inputType&&(a.placeholder="YYYY-MM-DDTHH:MM:SS"),a},b}(d),b.exports=c},{"./typed.coffee":24}],16:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("jquery"),e=a("./typed.coffee"),d=function(a){function b(a,c,d,e){this.valueExpr=a.attr("value"),b.__super__.constructor.call(this,a,c,d,e)}return g(b,a),b.selector="output",b.prototype.inputTag="p",b.prototype.inputs=function(){return c()},b.prototype.inputAttrs=function(){var a;return a=b.__super__.inputAttrs.call(this),delete a.autocomplete,a},b.prototype.refValue=function(){return this.valueExpr?this.xpath(this.valueExpr):b.__super__.refValue.call(this)},b.prototype.loadFromModel=function(){var a;try{if(b.__super__.loadFromModel.call(this),this.refExpr||this.valueExpr)return this.el.find(".echoforms-elements > p").text(this.refValue())}catch(d){throw a=d,""+a+"<br/>Error found while setting initial value of output control: ["+c("<div/>").text(this.ui[0].outerHTML).html()+"]."}},b}(e),b.exports=d},{"./typed.coffee":24,jquery:"im90Iq"}],17:[function(a,b){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./input.coffee"),d=function(a){function b(a,c,d,e){this.start=parseInt(a.attr("start"),10),this.end=parseInt(a.attr("end"),10),this.step=parseInt(a.attr("step"),10),b.__super__.constructor.call(this,a,c,d,e)}return f(b,a),b.selector="range",b}(c),b.exports=d},{"./input.coffee":15}],18:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./input.coffee"),d=function(a){function b(){return e=b.__super__.constructor.apply(this,arguments)}return g(b,a),b.selector="secret",b.prototype.inputElementType="password",b}(c),b.exports=d},{"./input.coffee":15}],19:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("jquery"),e=a("./typed.coffee"),d=function(a){function b(a,d,e,f){var g,h,i;this.isMultiple="true"===a.attr("multiple"),this.valueElementName=a.attr("valueElementName"),this.items=function(){var b,d,e,f,j;for(e=a.children("item"),j=[],b=0,d=e.length;d>b;b++)g=e[b],f=[c(g).attr("label"),c(g).attr("value")],h=f[0],i=f[1],""===c(g).attr("value")&&(this.hasBlankOption=!0),null!=h&&h.length>0||(h=i),j.push([h,i]);return j}.call(this),b.__super__.constructor.call(this,a,d,e,f)}return g(b,a),b.selector="select",b.prototype.inputTag="select",b.prototype.valueElementTagName=function(a){var b,c;return null==a&&(a=this.ref()),b=[this.valueElementName],/:/.test(a[0].nodeName)&&(c=a[0].nodeName.split(":").shift()),null!=c&&b.unshift(c),b.join(":")},b.prototype.refValue=function(){var a,d,e,f,g;if(null!=this.valueElementName&&null!=this.refExpr){for(f=this.ref().children(),g=[],d=0,e=f.length;e>d;d++)a=f[d],g.push(c(a).text());return g}return b.__super__.refValue.call(this)},b.prototype.saveToModel=function(){var a,d,e,f,g,h,i,j,k;if(null!=this.valueElementName&&null!=this.refExpr){for(e=this.ref().empty(),f=this.valueElementTagName(e),j=this.inputValue(),k=[],h=0,i=j.length;i>h;h++)g=j[h],a=document.createElementNS(e[0].namespaceURI,f),d=c(a).text(g),e.append(d),k.push(d[0].namespaceURI=e[0].namespaceURI);return k}return b.__super__.saveToModel.call(this)},b.prototype.loadFromModel=function(){var a,d;return null!=this.valueElementName&&null!=this.refExpr?(this.validate(),d=function(){var b,d,e,f;for(e=this.ref().children(),f=[],b=0,d=e.length;d>b;b++)a=e[b],f.push(c(a).text());return f}.call(this),this.isMultiple||(d=d[0]),this.inputs().val(d)):b.__super__.loadFromModel.call(this)},b.prototype.inputValue=function(){var a;return a=this.inputs().val(),null==this.valueElementName||a instanceof Array||(a=null!=a&&""!==a?[a]:[]),a},b.prototype.inputAttrs=function(){return c.extend(b.__super__.inputAttrs.call(this),{multiple:this.isMultiple})},b.prototype.hasModelVal=function(){return this.ref().children().length>0},b.prototype.buildElementsDom=function(){var a,d,e,f,g,h,i,j;for(e=b.__super__.buildElementsDom.call(this),a=e.children("select"),this.required()?this.hasBlankOption||this.hasModelVal()||a.append('<option value=""> -- Select a value -- </option>'):this.hasBlankOption||this.hasModelVal()||a.append('<option value=""> -- No Selection -- </option>'),i=this.items,g=0,h=i.length;h>g;g++)j=i[g],d=j[0],f=j[1],c("<option>",{value:f}).text(d).appendTo(a);return e},b}(e),b.exports=d},{"./typed.coffee":24,jquery:"im90Iq"}],20:[function(a,b){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./select.coffee"),d=function(a){function b(a,c,d,e){var f;f=a.attr("valueElementName"),null==f&&a.attr("valueElementName","value"),b.__super__.constructor.call(this,a,c,d,e)}return f(b,a),b.selector="selectref",b.prototype.buildDom=function(){return b.__super__.buildDom.call(this).addClass("echoforms-control-select")},b}(c),b.exports=d},{"./select.coffee":19}],21:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("./typed.coffee"),c=function(a){function b(){return e=b.__super__.constructor.apply(this,arguments)}return g(b,a),b.selector="textarea",b.prototype.inputTag="textarea",b}(d),b.exports=c},{"./typed.coffee":24}],22:[function(a,b){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("jquery"),g=a("./typed.coffee"),f=a("./treeitem.coffee"),d=a("./base.coffee"),e=function(a){function b(a,e,g,h){var i,j;i=a.attr("id"),i&&"control"!==i&&(i+="-"+d.echoformsControlUniqueId++,a.attr("id",i)),this.separator=a.attr("separator"),this.cascade=null!=a.attr("cascade")?"true"===a.attr("cascade"):!0,this.valueElementName=a.attr("valueElementName")||"value",this.items=function(){var b,d,i,k;for(i=a.children("item"),k=[],b=0,d=i.length;d>b;b++)j=i[b],k.push(new f(c(j),e,g,h,"",this.separator,this));return k}.call(this),b.__super__.constructor.call(this,a,e,g,h)}return i(b,a),b.selector="tree",b.prototype.inputTag="div",b.prototype.validate=function(){var a,c,d,e;for(b.__super__.validate.call(this),e=this.items,c=0,d=e.length;d>c;c++)a=e[c],a.subtree_handle_relevant_or_required();return null!=this.el?this.saveToModel():void 0},b.prototype.valueElementTagName=function(a){var b,c;return null==a&&(a=this.ref()),b=[this.valueElementName],/:/.test(a[0].nodeName)&&(c=a[0].nodeName.split(":").shift()),null!=c&&b.unshift(c),b.join(":")},b.prototype.refValue=function(){var a,d,e,f,g;if(null!=this.valueElementName&&null!=this.refExpr){for(f=this.ref().children(),g=[],d=0,e=f.length;e>d;d++)a=f[d],g.push(c(a).text());return g}return b.__super__.refValue.call(this)},b.prototype.saveToModel=function(){var a,d,e,f,g,h,i,j,k;if(null!=this.valueElementName&&null!=this.refExpr){for(e=this.ref().empty(),f=this.valueElementTagName(e),j=this.inputValue(),k=[],h=0,i=j.length;i>h;h++)g=j[h],a=document.createElementNS(e[0].namespaceURI,f),d=c(a).text(g),e.append(d),k.push(d[0].namespaceURI=e[0].namespaceURI);return k}return b.__super__.saveToModel.call(this)},b.prototype.loadFromModel=function(){},b.prototype.modelValues=function(){var a,b;return null!=this.valueElementName&&null!=this.refExpr?b=function(){var b,d,e,f;for(e=this.ref().children(),f=[],b=0,d=e.length;d>b;b++)a=e[b],f.push(c(a).text());return f}.call(this):[]},b.prototype.inputs=function(){return this.el.find("div.jstree")},b.prototype.inputValue=function(){var a,b,d;return a=[],b=this.inputs().find("a.jstree-clicked").parent().map(function(){var b;return b=c(this),b.attr("node_value")&&"true"===b.attr("relevant")&&"undefined"==typeof b.attr("required")?a.push(b.attr("node_value")):void 0}),d=this.inputs().find("li[required=required]").map(function(){var b;return b=c(this),b.attr("node_value")&&"true"===b.attr("relevant")?a.push(b.attr("node_value")):void 0}),a},b.prototype.inputAttrs=function(){return c.extend(b.__super__.inputAttrs.call(this),{separator:this.separator,cascade:this.cascade})},b.prototype.buildElementsDom=function(){var a,c,d,e,f,g;return f=(new Date).getTime(),d=b.__super__.buildElementsDom.call(this),e=d.children("div"),e.addClass("jstree"),e.append("<ul>"),g=e.children("ul"),a=0,c=this.items,function(){var b,d,e,h,i,j;for(j=[],d=h=a,i=c.length-1;i>=h&&(b=c[d],null!=b);d=h+=1)e=b.buildElementsDom(),e.appendTo(g),a<c.length-1&&(new Date).getTime()-f>40?(console.log("Tree construction yielding to browser to avoid unresponsive script"),j.push(setTimeout(arguments.callee,0))):j.push(void 0);return j}(),e.jstree({checkbox:{keep_selected_style:!1,three_state:this.cascade},plugins:["checkbox"]}),this.tree_root=e,console.log("Completed building Tree control in "+((new Date).getTime()-f)/1e3+" seconds"),d},b}(g),b.exports=e},{"./base.coffee":8,"./treeitem.coffee":23,"./typed.coffee":24,jquery:"im90Iq"}],23:[function(a,b){var c,d,e,f=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};c=a("jquery"),e=a("../util.coffee"),d=function(){function a(b,d,e,f,g,h,i){var j;this.separator=h,this.label=c(b).attr("label"),this.value=c(b).attr("value"),this.relevantExpr=c(b).attr("relevant"),this.requiredExpr=c(b).attr("required"),this.model=d,this.resolver=f,null!=this.label&&this.label.length>0||(this.label=this.value),null!=h&&h.length>0&&(this.value=g+this.separator+this.value),this.ui=b,this.tree=i,this.items=function(){var g,h,k,l;for(k=b.children("item"),l=[],g=0,h=k.length;h>g;g++)j=k[g],l.push(new a(c(j),d,e,f,this.value,this.separator,i));return l}.call(this)}return a.selector="item",a.prototype.inputTag="li",a.prototype.xpath=function(a){return e.execXPath(this.model,a,this.resolver)},a.prototype.node_required=function(){return!(null==this.requiredExpr||!this.xpath(this.requiredExpr))},a.prototype.node_relevant=function(){return null==this.relevantExpr||!!this.xpath(this.relevantExpr)},a.prototype.handle_relevant_or_required=function(){var a,b;return b=this.tree.tree_root,a=b.find("[node_value = '"+this.value+"']"),a.attr("required",this.node_required()),a.attr("relevant",this.node_relevant()),this.node_relevant()?this.node_required()?(b.jstree("enable_node",a),b.jstree("disable_checkbox",a),a.css("font-style","italic"),a.find("a").css("font-style","italic"),a.find("i.jstree-checkbox").addClass("jstree-required-icon").removeClass("jstree-checkbox")):b.jstree("enable_node",a):(b.jstree("disable_node",a),b.jstree("set_type",a,"disabled"),a.css("font-style","italic"),a.find("a").css("font-style","italic"),a.find("i.jstree-checkbox").addClass("jstree-dissabled-icon").removeClass("jstree-checkbox"))},a.prototype.subtree_handle_relevant_or_required=function(){var a,b,c,d,e;for(this.handle_relevant_or_required(),d=this.items,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.subtree_handle_relevant_or_required());return e},a.prototype.buildHelpDom=function(){var a,b,d,e,f;for(b=c("<span>",{"class":"echoforms-help"}),f=this.ui.children("help"),d=0,e=f.length;e>d;d++)a=f[d],this.addHelpText(b,c(a).text());return b},a.prototype.addHelpText=function(a,b){return c("<p>",{"class":"echoforms-help-item"}).text(b).attr({title:b}).appendTo(a)},a.prototype.buildElementsDom=function(){var a,b,d,e,g,h,i,j;return d=c("<li>"),d.attr({node_value:this.value}),e=this.buildHelpDom(),b={},i=this.tree.modelValues(),i.length>0&&(j=this.value,f.call(i,j)>=0)&&(b.selected=!0),this.node_relevant()||(b.disabled=!0,b.selected=!1,this.addHelpText(e,"[not available]")),this.node_required()&&(b.selected=!0,this.addHelpText(e,"[required]")),d.attr({relevant:this.node_relevant()}),Object.keys(b).length>0&&d.attr({"data-jstree":JSON.stringify(b)}),d.text(this.label),d.append(e),a=c("<ul>"),g=0,h=this.items,function(){var b,c,d,e,f,i,j;for(e=(new Date).getTime(),j=[],c=f=g,i=h.length-1;i>=f&&(b=h[c],null!=b);c=f+=1)d=b.buildElementsDom(),d.appendTo(a),g<h.length-1&&(new Date).getTime()-e>40?(console.log("TreeItem construction yielding to browser to avoid unresponsive script"),j.push(postMessage("script-timeout-message","*"))):j.push(void 0);return j}(),this.items.length>0&&a.appendTo(d),d},a}(),b.exports=d},{"../util.coffee":33,jquery:"im90Iq"}],24:[function(a,b){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("jquery"),d=a("./base.coffee"),e=a("../constraints/type.coffee"),f=function(a){function b(a,c,d,e){var f;this.inputType=(null!=(f=a.attr("type"))?f:"string").replace(/^.*:/,"").toLowerCase(),b.__super__.constructor.call(this,a,c,d,e),this.inputs().bind("click change",this.onChange)}return h(b,a),b.prototype.loadConstraints=function(){return b.__super__.loadConstraints.call(this),this.constraints.push(new e(this.inputType))},b.prototype.inputs=function(){return null!=this._inputs?this._inputs:this._inputs=this.el.find(":input")},b.prototype.inputValue=function(){return c.trim(this.inputs().val())},b.prototype.inputAttrs=function(){var a,b;return{id:""+this.id+"-element","class":"echoforms-element-"+(null!=(a=null!=(b=this.inputElementType)?b:this.inputClass)?a:this.ui[0].nodeName),autocomplete:"off"}},b.prototype.saveToModel=function(){return b.__super__.saveToModel.call(this),this.refExpr?this.ref().text(this.inputValue()):void 0},b.prototype.loadFromModel=function(){return b.__super__.loadFromModel.call(this),this.refExpr?this.inputs().val(this.refValue()):void 0},b.prototype.buildDom=function(){return b.__super__.buildDom.call(this).addClass("echoforms-typed-control")},b.prototype.buildElementsDom=function(){return b.__super__.buildElementsDom.call(this).append(c("<"+this.inputTag+">",this.inputAttrs()))},b}(d),b.exports=f},{"../constraints/type.coffee":6,"./base.coffee":8,jquery:"im90Iq"}],25:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./output.coffee"),d=function(a){function b(){return e=b.__super__.constructor.apply(this,arguments)}return g(b,a),b.selector="output[type$=anyURI], output[type$=anyuri]",b.prototype.inputTag="a",b.prototype.inputAttrs=function(){var a;return a=b.__super__.inputAttrs.call(this),a.href="#",a},b.prototype.loadFromModel=function(){var a;return a=this.refValue(),this.refExpr||this.valueExpr?this.el.find(".echoforms-elements > a").text(a).attr("href",a):void 0},b}(c),b.exports=d},{"./output.coffee":16}],26:[function(a,b){var c,d,e,f,g,h,i;c=a("jquery"),i=a("./util.coffee"),f=a("./controls/index.coffee"),e=a("./controls/form.coffee"),jQuery.expr[":"].hasNoValue=function(a){return 0===jQuery.trim(jQuery(a).text()).length},g=f.matchList.concat(),h={controls:[]},d=function(){function a(a,b){var d,f,j,k,l,m,n;
this.root=a;try{this.options=c.extend({},h,b),this.form=k=this.options.form,this.controlClasses=d=this.options.controls.concat(g),null==k&&i.error("You must specify a 'form' option when creating a new ECHO Forms instance"),this.resolver=m=i.buildXPathResolverFn(k),this.doc=f=c(i.parseXML(k)),this.model=l=f.find("form > model > instance"),this.ui=n=f.find("form > ui"),this.control=new e(n,l,d,m),this.root.append(this.control.element()),this.control.addedToDom()}catch(o){throw j=o,i.error(j),j}}return a.registerControl=function(a,b){return null==b&&(b={}),g.unshift(a)},a.prototype.destroy=function(){return this.root.empty()},a.prototype.isValid=function(){return this.control.isValid()},a.prototype.serialize=function(a){return this.control.serialize(a)},a}(),b.exports=d},{"./controls/form.coffee":11,"./controls/index.coffee":14,"./util.coffee":33,jquery:"im90Iq"}],browser:[function(a,b){b.exports=a("ZyMBMU")},{}],ZyMBMU:[function(a,b){!function(a,c){return b.exports={document:a,window:c}}(document,window)},{}],jquery:[function(a,b){b.exports=a("im90Iq")},{}],im90Iq:[function(a,b){b.exports=jQuery},{}],31:[function(a,b){b.exports=a("./echoform.coffee")},{"./echoform.coffee":26}],32:[function(a){var b,c,d,e,f,g=[].slice;b=a("jquery"),f=a("./util.coffee"),d=a("./controls/index.coffee"),e=a("./config.coffee").pluginName,c=a("./echoform.coffee"),b[e]={control:function(a,d){return null==d&&(d={}),c.registerControl(a),d["export"]&&(b[e].controls[a.name]=a),this},controls:b.extend({},d.classes),extras:b.extend({},d.extras)},b.fn[e]=function(){var a,d,h,i;return a=1<=arguments.length?g.call(arguments,0):[],a.length>0&&"string"==typeof a[0]?(i=a,d=i[0],a=2<=i.length?g.call(i,1):[],h=this.map(function(){var c,h,i,j;return h=b.data(this,e),h?/^debug_/.test(d)?(j=d.split("_"),i=j[0],c=2<=j.length?g.call(j,1):[],h[c.join("_")]):"destroy"!==d?/^_/.test(d)||"function"!=typeof(null!=h?h[d]:void 0)?(f.error("Could not call "+d+" on "+e+" instance:",this),null):h[d].apply(h,a):(b.removeData(this,e),"function"==typeof(null!=h?h.destroy:void 0)?h.destroy():void 0):(f.warn(""+e+" not found on instance"),this)}),h[0]):a.length<2?this.each(function(){var d;return d=a[0],null==b.data(this,e)?b.data(this,e,new c(b(this),d)):void 0}):(f.error("Bad arguments to "+e+":",a),this)}},{"./config.coffee":1,"./controls/index.coffee":14,"./echoform.coffee":26,"./util.coffee":33,jquery:"im90Iq"}],33:[function(a,b){var c,d,e,f,g,h,i,j,k=[].slice;j=a("browser").window,i=!1,h=function(){var a;return a=1<=arguments.length?k.call(arguments,0):[],"undefined"!=typeof console&&null!==console?"function"==typeof console.warn?console.warn.apply(console,a):void 0:void 0},d=function(){var a;return a=1<=arguments.length?k.call(arguments,0):[],"undefined"!=typeof console&&null!==console&&"function"==typeof console.error&&console.error.apply(console,a),null!=$("#form_load_errors")?$("#form_load_errors").append("<div class='form_load_error'>"+a+"</div>"):void 0},e=function(a,b,c){var e,f,g;return i||"undefined"!=typeof wgxpath&&null!==wgxpath&&"function"==typeof wgxpath.install&&wgxpath.install(j),i=!0,a.length<1&&d("Error processing xpath ["+b+"].  Provided context node was not valid. Verify that the ref attribute of the parent group is valid (including the namespace)."),"["===(null!=b?b.charAt(0):void 0)&&(b="self::*"+b),"true"===b?!0:"false"===b?!1:(e=a[0].ownerDocument,b=b.replace(/^\/+|(https:)?\/\//g,function(a,b){return b?a:"/descendant-or-self::node()/"}),null==e.evaluate&&wgxpath.install({document:e}),f=e.evaluate(b,a[0],c,XPathResult.ANY_TYPE,null),g=function(){switch(f.resultType){case XPathResult.NUMBER_TYPE:return f.numberValue;case XPathResult.STRING_TYPE:return f.stringValue;case XPathResult.BOOLEAN_TYPE:return f.booleanValue;default:return f.iterateNext()}}())},f=function(a){var b,c;if(!a||"string"!=typeof a)return null;c=void 0;try{j.DOMParser?c=(new DOMParser).parseFromString(a,"text/xml"):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a))}catch(e){b=e}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||d("Invalid XML: "+a),c},c=function(a){var b,c,d,e,f,g,h;for(f={},b=" default ",e=/\sxmlns(?::(\w+))?=\"([^\"]+)\"/g;null!=(c=e.exec(a));)h=c.slice(1,3),d=h[0],g=h[1],f[null!=d?d:b]=g;return function(a){return f[null!=a?a:b]}},g=function(a,b){var c,d;if(null==b&&(b={}),d="",c="","#text"===a.nodeName)return""+d+$("<div/>").text(a.nodeValue).html();if("#comment"===a.nodeName)return""+d+"<!--"+a.nodeValue+"-->";for(var e=0;e<a.attributes.length;e++){var f=a.attributes[e].name,h=a.attributes[e].value;c+=" "+f+'="'+h+'"',/xmlns/.test(f)&&"xmlns"!=f&&(b[f.split(":").pop()]=h)}if(null==a.prefix)for(prefix in b)if(b.hasOwnProperty(prefix)&&b[prefix]==a.namespaceURI){a.prefix=prefix;break}d+="<"+a.nodeName,d+=""+c+">";for(var e=0;e<a.childNodes.length;e++)d+=g(a.childNodes[e],b);return""+d+"</"+a.nodeName+">"},b.exports={warn:h,error:d,execXPath:e,parseXML:f,buildXPathResolverFn:c,printDOMToString:g}},{browser:"ZyMBMU"}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,"ZyMBMU","im90Iq",31,32,33]);