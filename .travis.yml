language: node_js
addons:
  chrome: stable
  apt:
    packages:
      # Ubuntu 16+ does not install this dependency by default, so we need to install it ourselves
      - libgconf-2-4
cache:
  npm: true
  directories:
    # we also need to cache folder with Cypress binary
    - ~/.cache
branches:
  only:
    - master
script:
  - npm install
  - npm run cypress:run
before_deploy: "npm run predeploy"
deploy:
  - provider: script
    script: bin/ecc-sync
    on:
      branch: master
      repo: nasa/edsc-echoforms
  - provider: pages
    skip_cleanup: true
    github_token: $GITHUB_TOKEN
    local_dir: dist
    on:
      branch: master
      repo: nasa/edsc-echoforms
